<!DOCTYPE html>

<html>
<head>
	<title>VF Hosted app</title>

	<script src="phonegap.js"></script>
	<script src="childbrowser.js" ></script>

	<script type="text/javascript" src="scripts/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="scripts/forcetk.js"></script>
	<script type="text/javascript" src="scripts/loginToSf.js"></script>

	<script type="text/javascript">
		function log (txt) {
			//setTimeout (function() { alert (txt);}, 0);
			$ ('#log').append ($ ('<li>').append ('<pre>').html (txt));
		}

		String.prototype.startsWith = function (str) { return (this.substr(0, str.length) === str); }

		function dispatchMessage (msg) {
			alert('data: ' + msg.data + '\norigin: ' + msg.origin);

			// send message back to VF page
			setTimeout (function () { msg.source.postMessage('a', '*'); });
		}
		window.addEventListener('message', dispatchMessage, false);

		var logedinCallback = function (oauth) {
			$('body').append([
				'<iframe width="100%" height="300" id="VFhosted"',
					'sandbox="allow-same-origin allow-top-navigation allow-forms allow-scripts"',
					'src="https://c.eu2.visual.force.com/apex/PhoneGap_VF_Hosted">',
				'</iframe>'
			].join(''));
		};

		function deviceReady () {
			loginToSf();
		}
	</script>
</head>

<body onload="document.addEventListener('deviceready', deviceReady, false);">
	<h1>App hosted page</h1>

</body>
</html>
